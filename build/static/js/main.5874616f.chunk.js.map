{"version":3,"sources":["App.js","index.js","config.js"],"names":["App","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","state","appID","localStorage","getItem","API_KEY","indexName","query","rules","rule","handleChange","bind","assertThisInitialized","handleSubmit","setRule","e","_this2","target","name","setState","value","algoliasearch","initIndex","searchRules","then","_ref","hits","catch","err","alert","message","from","until","setItem","_this3","preventDefault","index","_ref2","objectID","condition","consequence","validity","moment","unix","description","saveRule","res","concat","local","format","react_default","a","createElement","_this4","map","className","key","onClick","_renderValidity","_metadata","lastUpdate","href","type","placeholder","onChange","onSubmit","_renderRules","App_RenderTime","Component","RenderTime","ReactDOM","render","src_App_0","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.5874616f.chunk.js","sourcesContent":["import React, { Component } from 'react';\nimport algoliasearch from 'algoliasearch';\nimport './App.css';\nimport moment from 'moment';\nimport {appID, API_KEY, indexName} from './config.js'\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      appID: localStorage.getItem('rules_app_id') || appID || \"appID\",\n      API_KEY: localStorage.getItem('rules_api_key') || API_KEY || \"API_KEY\",\n      indexName: localStorage.getItem('rules_index_name') || indexName || \"atis-prods\",\n      query: \"\",\n      rules: [],\n      rule: \"\"\n    };\n    this.handleChange = this.handleChange.bind(this);\n    this.handleSubmit = this.handleSubmit.bind(this);\n    this.setRule = this.setRule.bind(this);\n  }\n\n  handleChange(e) {\n    switch (e.target.name) {\n      case \"appID\":\n        this.setState({ appID: e.target.value });\n        break;\n      case \"API_KEY\":\n        this.setState({ API_KEY: e.target.value });\n        break;\n      case \"indexName\":\n        this.setState({ indexName: e.target.value });\n        break;\n      case \"query\":\n        if (e.target.value === \"\") {\n          this.setState({ query: e.target.value, rule: \"\", rules: [] });\n        } else {\n          this.setState({ query: e.target.value, rule: \"\" });\n        }\n        const searchClient = algoliasearch(this.state.appID, this.state.API_KEY);\n        const index = searchClient.initIndex(this.state.indexName);\n        index.searchRules(this.state.query)\n          .then(({ hits }) => {\n            this.setState({ rules: hits });\n          })\n          .catch(err => {\n            alert(err.message);\n          })\n        break;\n      case \"from\":\n        this.setState({ from: e.target.value });\n        break;\n      case \"until\":\n        this.setState({ until: e.target.value });\n        break;\n      default:\n        this.setState({ query: e.target.value });\n        break;\n    }\n  }\n   \n  setRule(rule) {\n    this.setState({ rule: rule, rules: [rule] });\n    localStorage.setItem('rules_app_id', this.state.appID)\n    localStorage.setItem('rules_api_key', this.state.API_KEY)\n    localStorage.setItem('rules_index_name', this.state.indexName)\n  }\n  \n  handleSubmit(e) {\n    e.preventDefault();\n    const searchClient = algoliasearch(this.state.appID, this.state.API_KEY);\n    const index = searchClient.initIndex(this.state.indexName);\n    if (e.target.name === \"query\") {\n      index.searchRules(this.state.query)\n        .then(({ hits }) => {\n          this.setState({ rules: hits });\n        })\n        .catch(err => alert(err.message));\n    }\n    if (e.target.name === \"time\") {\n      const rule = {\n        objectID: this.state.rule.objectID,\n        condition: this.state.rule.condition,\n        consequence: this.state.rule.consequence,\n        validity: [\n          {\n            from: moment(this.state.from).unix(),\n            until: moment(this.state.until).unix()\n          }\n        ],\n        description: this.state.rule.description,\n      }\n      index.saveRule(rule)\n        .then((res) => {\n          alert(`Saving rule ${rule.objectID} valid from ${moment(this.state.from).local().format('llll')} until ${moment(this.state.until).local().format('llll')}`)\n        })\n        .catch(err => alert(err.message))\n      // alert(`Saving rule ${rule.objectID} valid from ${moment(this.state.from).local().format('llll')} until ${moment(this.state.until).local().format('llll')}`)\n      // index.saveRule(rule).wait()\n      //   .then((res) => {\n      //     alert(`Completed Saving rule ${rule.objectID} valid from ${moment(this.state.from).local().format('llll')} until ${moment(this.state.until).local().format('llll')}`)\n      //   })\n      //   .catch(err => alert(err.message))\n    }\n  }\n  _renderValidity(rule) {\n    if (rule.validity) {\n      return (<div><div><b>Active From:</b> {moment.unix(rule.validity[0].from).format('llll')}</div><div> <b>Until:</b> {moment.unix(rule.validity[0].until).format('llll')}</div></div>)\n    } else {\n      return (\"\");\n    }\n  }\n  \n  _renderRules() {\n    return this.state.rules.map((rule, index) => (\n      <button className='rule-button' key={index} onClick={() => this.setRule(rule)}>\n        <div>\n          <b>objectID:</b> {rule.objectID}\n        </div>\n        <div>\n          <b>Description:</b> {rule.description || 0}\n        </div>\n        {this._renderValidity(rule)}\n        <div>\n          <b>Last Updated:</b> {moment.unix(rule._metadata.lastUpdate).format('llll') || 0}\n        </div>\n      </button>\n    ))\n  }\n\n  render() {\n    return (\n      <div>\n        <header className=\"header\">\n          <h1 className=\"header-title\">\n            <a href=\"/\">rules-time</a>\n          </h1>\n          <div className=\"input-container\">\n            AppID:\n            <input type=\"text\" name='appID' placeholder={this.state.appID} onChange={this.handleChange} />\n          </div>\n          <div className=\"input-container\">\n            API_KEY:\n            <input type=\"text\" name='API_KEY' placeholder={this.state.API_KEY} onChange={this.handleChange} />\n          </div>\n          <div className=\"input-container\">\n            indexName:\n            <input type=\"text\" name='indexName' placeholder={this.state.indexName} onChange={this.handleChange} />\n          </div>\n        </header>\n\n        <div className=\"container\">\n            <div className=\"search-panel\">\n              <div className=\"search-panel__results\">\n              <form name=\"query\" onSubmit={this.handleSubmit}>\n                <label>\n                  <b>Search for Rule:</b>\n                  <input type=\"text\" name=\"query\" placeholder=\"Search for contexts, descriptions, or strategies\" onChange={this.handleChange} />\n                </label>\n                {/* <input type=\"submit\" name=\"query\" value=\"Look for Rule\" /> */}\n              </form>\n              {this._renderRules()}\n              {(this.state.rule ? \n              <RenderTime \n                  handleChange={this.handleChange}\n                  handleSubmit={this.handleSubmit}\n              /> : \n              \"\")}\n              </div>\n            </div>\n        </div>\n      </div>\n    );\n  }\n}\n\nconst RenderTime = (props) => {\n  return (\n    <div>\n      <form name=\"time\" onSubmit={props.handleSubmit}>\n        <div>\n          <b>Set Active Time</b>\n        </div>\n        <label>\n          From: <input type=\"text\" name=\"from\" placeholder=\"07-25-2020 08:00 PDT\" onChange={props.handleChange} />\n        </label>\n        <label>\n          Until: <input type=\"text\" name=\"until\" placeholder=\"08-20-2020 15:00 PDT\" onChange={props.handleChange} />\n        </label>\n        <input type=\"submit\" value=\"Submit Change\" />\n      </form>\n    </div>\n  )\n}\n\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\n\nReactDOM.render(<App />, document.getElementById('root'));\n","\nconst appID = \"APPID\";\nconst API_KEY = \"ADMIN_API_KEY\";\nconst indexName = \"products_staging\";\n\nmodule.exports = {\n  appID,\n  API_KEY,\n  indexName\n}"],"sourceRoot":""}